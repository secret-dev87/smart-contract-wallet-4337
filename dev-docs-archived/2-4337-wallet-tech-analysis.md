/*
 * @Author: jhfnetboy 
 * @Date: 2022-07-18 21:56:24 
 * @Last Modified by: jhfnetboy
 * @Last Modified time: 2022-07-18 21:57:24
 */

### 4337技术实现分析
+ 本文会从技术实现角度，分析预演整个主要技术过程。
+ 主要场景和核心技术的结构图
+ 
#### 签名全过程

#### 其他签名算法

#### EOA

#### EOA发起交易

#### 交易链路和MEV

#### 4337协议解读

#### Entryporint和Bundler

#### 4337的Tx执行过程

#### 风险分析和应对(可能的QA)

#### 风险1 安全中心单点故障

它是为SoulWallet用户服务的中心应用程序，它是单点故障。 

+ 不好:如果服务器被黑，所有数据泄露，用户的邮箱和合约钱包地址、监护人公钥签名hash都会泄露，不会直接造成客户损失。

+ 回应:我们会加密数据，以防泄露风险。我们将设置监视器来阻止恶意请求(这取决于请求数据和模型训练)。我们在OAuth2和ECDSA的基础上验证好的请求。 

+ 最大风险就是所有数据泄露，因为安全中心服务器是为便利性而增加的过程数据，例如恢复记录、匹配关系等，并非私钥等核心数据，因此用户email和合约钱包地址、guardian公钥签名hash被泄露，不会造成直接客户损失。
+ 另外，Email等数据会进行hash加密，被泄露了也需要高成本解密才可以取到（PoC阶段无此功能）。
+ 安全中心会以开源和开放方式，各个生态合作伙伴去中心运作，只为提供便利性，也杜绝了影响所有钱包可用性、稳定性。

#### 风险2 服务器被劫持

+ 如果服务器被劫持，假API会得到客户的上述数据，但签名是加密哈希，无法破解？ 

+ 不好:因为链上契约持有验证加密密钥的行为，所以假API什么也做不了(我们会作证)。 

+ 应对:提高服务器端的稳定性，降低安全中心的能力。 

+ 则fake API会获取客户的上述数据，但签名是hash后的，只能用于特定的交易，无法获利。

#### 风险3 +如果默认监护人是用私钥哈希或者私钥被黑

对于只有一个监护人的那一个来说是有风险的，所以设置至少2个监护人更安全。 

+ Bad: Make用户必须至少设置2个监护人(总共2个)，否则他们可能会因为缺省监护人而丢失。
+ Response:下调默认监护人的权限，使其只能由用户触发，无权调用契约来替换密钥。
+ 单个Guardain私钥丢失不会影响恢复，一般建议三个guardian，需要至少3guardian是比较安全。
+ 另外owner和guardian之间是不透明关系，作为guardian不知道谁设置你为guardian了。
+ 不同资产级别可以未来选择不同的安全配置。 

#### 风险4 便利性和安全性

用户在安全设置上无法做出正确的选择。

+ 不好:他们可能会因为错误的设置而失去便利性或安全性。 
+ 回应:所以，对于持有大于10000U的客户，建议同时设置Web2+Web3守护，最好是3/5，这样更安全。
+ 或者他们可以通过在安全中心设置更多审计规则来换取方便和安全。我们稍后将为用户提供安全模块。 

#### 风险5 最好记录自己钱包和监护人地址

+ 并自己在断开的手机上记录钱包和监护人地址

+ 恢复时在mac+chrome环境下恢复。 
+ +坏: 如果你丢失了所有，在恢复时你无法邀请你的guardian签名
+ +响应: 牺牲部分安全性，让安全中心作为你的默认guardian并记录你的其他guardian地址

#### 风险6 如果用户丢失了合同钱包地址或监护人列表

他们将无法再查看他们的钱包。 

+ 不好:他们会因为不小心记录而损失财产。 
+ 回应:所以我们建安全中心！记录以上所有内容。此外，还可以定期找回一次私钥，设置单日限额+移账预警，基本控制最小损失，私钥被盗后可以及时更换，恢复控制权。